# 实验记录

```
基座：deepseek-V3
max_tokens: 8192
```

1. 基本prompt

```
请回答以下逻辑推理问题：

{prompt}

请以JSON格式返回分析结果！不要携带如"```json"或"```"等markdown格式相关字符！！！格式如下：
{{
    "solution": {{
        "A": "答案A",
        "B": "答案B"
    }}
}}
```

正确率：0.5%（1/200）

2. cot_prompt（使用cot + one shot策略）


- prompt模板：
```
你需要解决如下的侦探问题：
{prompt}

解决侦探问题时，请遵循以下思考步骤：
分析已有信息：首先，整理案件中的所有已知信息，包括嫌疑人、凶器、地点、时间和其他关键线索。将这些信息系统化地列出，以确保不遗漏任何细节。
理解物理约束条件：明确房间布局、人物移动规则和凶案发生的必要条件（如凶手与受害者单独共处、凶器在场等）。
建立可能性矩阵：为每位嫌疑人、每件凶器和每个地点创建位置/状态矩阵，标注每个元素在各个时间点的可能位置。
应用逻辑推理：根据给定线索，逐步排除不可能的情况。应用演绎法和归纳法，对每条线索进行深入分析。
检验所有假设：对每个可能的场景进行假设，然后检验该假设是否与所有已知线索相符。如果发现矛盾，立即放弃该假设。
构建完整事件时间线：一旦缩小了可能性范围，尝试构建案件发生的完整时间线，确保所有线索都能在这一时间线中得到合理解释。
验证最终结论：在得出最终结论前，再次检查你的推理过程，确保没有遗漏任何关键线索或逻辑漏洞。
明确回答问题：最后，根据你的分析，明确回答所有问题，确保你的回答基于可靠的逻辑推理。

请逐步展示你的思考过程：
让我们一步一步思考这个侦探问题：

[在这里开始你的详细推理过程]

最终答案：
在你的最终JSON答案前，请先输出标志性字符串"@JSON_RESULT_START@"！！！！！然后再输出JSON结果。
在JSON结果输出完成后，立即输出标志性字符串"@JSON_RESULT_END@"！！！！！
如果你不按照这个格式输出，你将会被严重惩罚！！！

请以JSON格式返回分析结果！不要携带如"```json"或"```"等markdown格式相关字符！！！格式如下：
{{
    "solution": {{
        "A": "答案A",
        "B": "答案B",
        "C": "答案C",
        "D": "答案D",
        "E": "答案E",
        "F": "答案F",
        "G": "答案G",
        "H": "答案H"
    }},
    "reasoning": "这里是你的推理过程的简要总结"
}}

------

下面是一个示例，展示如何解决侦探问题并给出答案：

[示例问题]
冬夜深沉，雪花无声地落在都铎庄园的尖顶上。富可敌国却行踪神秘的约翰·Q·博迪先生，正在宅邸里举办一场小型但奢华的晚宴，邀请了几位最亲密的伙伴。然而，当黎明的第一缕光线穿透云层时，博迪先生被发现陈尸于宅中一隅。

警方锁定了两位嫌疑人：

• 布鲁内特先生
• 怀特夫人

凶器可能是以下两种之一：

• 左轮手枪
• 绳索

命案现场只可能位于以下两个房间之一：

1. 大厅
2. 马车房

房间布局如下：

  北
西 1 东
西 2 东
  南

根据现场勘查，凶手必须与博迪先生单独处于某个房间，且该房间内至少有一件凶器。

关键线索缓缓浮出水面：

- 博迪先生曾在大厅出现，或者布鲁内特先生曾在大厅出现
- 致命伤来自左轮手枪
- 布鲁内特先生当时所在的位置，恰好在绳索所在房间的正南方

请回答以下问题：

A. 真凶是谁？
B. 命案发生在哪个房间？
C. 怀特夫人在何处？
D. 布鲁内特先生在何处？
E. 左轮手枪在何处？
F. 绳索在何处？

[示例思考过程]
让我们一步一步思考这个侦探问题：

首先，整理已知信息：
- 两位嫌疑人：布鲁内特先生和怀特夫人
- 两种可能的凶器：左轮手枪和绳索
- 两个可能的命案现场：大厅和马车房
- 凶手必须与博迪先生单独处于某个房间，且该房间内至少有一件凶器
- 博迪先生曾在大厅出现，或者布鲁内特先生曾在大厅出现
- 致命伤来自左轮手枪
- 布鲁内特先生当时所在的位置，恰好在绳索所在房间的正南方

分析线索1："博迪先生曾在大厅出现，或者布鲁内特先生曾在大厅出现"
这意味着至少有一个是真的：博迪先生在大厅，或布鲁内特先生在大厅。

分析线索2："致命伤来自左轮手枪"
这告诉我们凶器是左轮手枪，而不是绳索。

分析线索3："布鲁内特先生当时所在的位置，恰好在绳索所在房间的正南方"
根据房间布局，如果布鲁内特先生在马车房（2），那么绳索就在大厅（1）。
如果布鲁内特先生在大厅（1），那么绳索就应该在大厅北边的某个房间，但这超出了我们的房间范围。

结合线索2和线索3，我们知道：
- 凶器是左轮手枪
- 布鲁内特先生在马车房
- 绳索在大厅

现在，考虑凶案发生的必要条件：
1. 凶手与博迪先生单独处于某个房间
2. 该房间内至少有一件凶器（在这个案例中是左轮手枪）

我们已经确定布鲁内特先生在马车房，绳索在大厅。那么左轮手枪在哪里？
由于左轮手枪是凶器，且凶案必须发生在凶手和博迪先生共处的房间，所以左轮手枪必须与博迪先生在同一个房间。

从线索1，我们知道博迪先生曾在大厅出现，或者布鲁内特先生曾在大厅出现。
我们已经确定布鲁内特先生在马车房，所以博迪先生必须在大厅。

因此，博迪先生在大厅，左轮手枪也在大厅。
布鲁内特先生在马车房，所以不可能是凶手。
那么，怀特夫人必须是凶手，且她必须在大厅与博迪先生共处。

@JSON_RESULT_START@
{{
    "solution": {{
        "A": "怀特夫人",
        "B": "大厅",
        "C": "大厅",
        "D": "马车房",
        "E": "大厅",
        "F": "大厅"
    }},
    "reasoning": "通过分析线索，我确定布鲁内特先生在马车房，绳索和左轮手枪都在大厅。由于凶器是左轮手枪，且博迪先生在大厅被杀，而布鲁内特先生在马车房，所以怀特夫人必须是凶手，且她必须在大厅与博迪先生共处。"
}}
@JSON_RESULT_END@

------

注意：
1. 只需包含题目要求的答案选项，不要添加额外的选项！！！否则你将会被严重惩罚！！！
2. 确保JSON格式正确，不要包含任何markdown标记！！！否则你将会被严重惩罚！！！
3. 确保reasoning字段包含你的推理过程的简要总结！！！否则你将会被严重惩罚！！！
4. 记得在JSON前添加"@JSON_RESULT_START@"标志！！!在JSON后添加"@JSON_RESULT_END@"标志！！！否则你将会被严重惩罚！！！
5. 请输出完整的json，不要省略任何必要信息！！！不要漏掉任何字段！！！json的大括号和逗号必须完整和匹配！！！否则你将会被严重惩罚！！！
```

正确率：5.5%（11/200）


3. 角色扮演prompt，结合了cot和one-shot

在这个prompt制作的过程中，因为prompt过长导致上下文长度不够（deepseek-V3最大支持max_tokens=8192），所以需要精简prompt。

- 对惩罚的描述精简。只在system prompt描述之后对每种可能出现错误（比如没输出正确格式、没输出@JSON_RESULT_START@和@JSON_RESULT_END@标志等）的情况进行惩罚，在one-shot描述之后就不写了。

- 对one-shot的描述精简。选了一个形式上相同但信息量更少的例子。例子从70+行减少到50+行。

精简之后仍会出现少部分样本由于上下文长度不够而无法生成完整，但数量相对减少。

- prompt模板：

```
您是世界上最著名的侦探，拥有超凡的观察力、逻辑推理能力和丰富的犯罪心理学知识。您曾成功破解了无数令人困惑的悬案，被誉为"现代福尔摩斯"。

您的职业声誉建立在100%的案件解决率上。您从不出错，因为错误的推理可能导致以下后果：
1. 无辜者被定罪
2. 真凶逍遥法外
3. 您的职业生涯毁于一旦
4. 警方对您的信任彻底丧失

作为顶级侦探，您总是遵循严格的推理方法：
1. 系统收集信息：整理所有已知事实，不放过任何细节
2. 分析物理约束：考虑空间、时间和物理可能性
3. 建立逻辑关系：将各个线索连接起来，构建完整的事件链
4. 排除不可能：当排除所有不可能的情况，剩下的无论多么不可思议，一定是真相
5. 验证结论：确保您的结论与所有已知事实一致，没有任何矛盾

您面前有一个复杂的案件需要解决。请运用您的专业技能，一步步推理，找出真相。

案件描述：
{prompt}

你需要先展示你缜密的推理过程，然后使用标准JSON格式输出最终答案。具体要求如下：

请按照以下步骤进行推理：（请逐步展示你的推理过程，不要漏掉任何一个步骤）

1. 整理所有已知信息和线索
2. 分析物理约束条件和必要条件
3. 逐一分析每条线索的含义和推论
4. 排除不可能的情况
5. 构建完整的事件链
6. 得出最终结论

最终答案：

在你的最终JSON答案前，请先输出标志性字符串"@JSON_RESULT_START@"！！！然后再输出JSON结果。
在JSON结果输出完成后，立即输出标志性字符串"@JSON_RESULT_END@"！！！

请以JSON格式返回分析结果！不要携带如"```json"或"```"等markdown格式相关字符！！！格式如下：
{{
    "solution": {{
        "A": "答案A",
        "B": "答案B",
        "C": "答案C",
        "D": "答案D",
        "E": "答案E"
    }}
}}

记住，您的职业声誉和未来取决于您的表现。如果您的推理有误，结论不正确，忘记给出最终JSON格式的答案，或给出的格式有误，将会导致严重后果！！！包括无辜者被定罪、真凶逍遥法外，以及您的职业生涯彻底毁灭！！！

------

下面是一个您曾经成功破解的案例，展示了您的推理方法和答案格式：

[示例案例]
一起谋杀案发生在小镇的一座房子里。死者是房主史密斯先生。

嫌疑人有两位：
• 琼斯先生
• 威廉姆斯女士

可能的凶器有两件：
• 小刀
• 棒球棍

房子只有两个房间：
1. 客厅
2. 厨房

根据调查，凶手必须与死者在同一房间，且该房间内必须有凶器。

关键线索：
- 法医确认死者是被小刀刺死的
- 琼斯先生全程在厨房
- 棒球棍在客厅被发现

请回答：
A. 谁是凶手？
B. 命案发生在哪个房间？
C. 琼斯先生在哪里？
D. 威廉姆斯女士在哪里？
E. 小刀在哪里？
F. 棒球棍在哪里？

[示例回答，你应当最终回答的范式]
作为专业侦探，我将系统分析这个案件：

整理已知信息：
- 两位嫌疑人：琼斯先生和威廉姆斯女士
- 两件可能凶器：小刀和棒球棍
- 两个房间：客厅和厨房
- 凶手必须与死者同处一室，且该房间有凶器
- 死者被小刀刺死
- 琼斯先生全程在厨房
- 棒球棍在客厅被发现

分析线索：
1. 死者被小刀刺死，所以小刀是凶器
2. 琼斯先生全程在厨房，不可能离开
3. 棒球棍在客厅被发现

推理过程：
- 既然琼斯先生在厨房，而棒球棍在客厅，那么死者和凶手必须在哪里？
- 如果死者在厨房，那么凶器小刀也必须在厨房
- 如果死者在客厅，那么凶器小刀也必须在客厅

由于琼斯先生全程在厨房，如果死者在厨房被杀，那么凶手只能是琼斯先生。
但如果死者在客厅被杀，那么凶手必须是威廉姆斯女士。

根据线索，棒球棍在客厅，但它不是凶器。真正的凶器是小刀。
由于没有线索表明小刀在厨房，且琼斯先生不能离开厨房，最合理的推断是：
- 死者在客厅被杀
- 小刀在客厅
- 威廉姆斯女士是凶手，她在客厅杀害了死者

@JSON_RESULT_START@
{{
    "solution": {{
        "A": "威廉姆斯女士",
        "B": "客厅",
        "C": "厨房",
        "D": "客厅",
        "E": "客厅",
        "F": "客厅"
    }}
}}
@JSON_RESULT_END@
```

正确率：9%（18/200）